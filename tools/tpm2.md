# Криптографический процессор TPM
   * [Управление TPM](#управление-tpm)
      * [Инициализация и управление устройством](#инициализация-и-управление-устройством)
      * [Управление иерархиями и авторизацией](#управление-иерархиями-и-авторизацией)
      * [Управление часами и генератором случайных чисел](#управление-часами-и-генератором-случайных-чисел)
      * [Самотестирование и аудит](#самотестирование-и-аудит)
   * [Управление ключами и объектами](#управление-ключами-и-объектами)
      * [Создание ключей](#создание-ключей)
      * [Загрузка, выгрузка и импорт объектов](#загрузка-выгрузка-и-импорт-объектов)
      * [Использование ключей](#использование-ключей)
      * [Миграция объектов](#миграция-объектов)
      * [Работа с учетными данными и сертификатами](#работа-с-учетными-данными-и-сертификатами)
   * [Криптографические операции](#криптографические-операции)
      * [Хеширование и HMAC](#хеширование-и-hmac)
      * [Симметричное шифрование/дешифрование](#симметричное-шифрованиедешифрование)
      * [Асимметричное шифрование/дешифрование RSA](#асимметричное-шифрованиедешифрование-rsa)
      * [Операции с эллиптическими кривыми](#операции-с-эллиптическими-кривыми)
      * [Проверка подписи](#проверка-подписи)
      * [Генерация случайных чисел](#генерация-случайных-чисел)
   * [Аттестация](#аттестация)
      * [Работа с PCR](#работа-с-pcr)
      * [Отчеты](#отчеты)
      * [Сертификация объектов](#сертификация-объектов)
   * [NV-память](#nv-память)
      * [Создание и удаление NV-индексов](#создание-и-удаление-nv-индексов)
      * [Чтение и запись в NV-память](#чтение-и-запись-в-nv-память)
      * [Блокировка и сертификация NV-индексов](#блокировка-и-сертификация-nv-индексов)
   * [Вспомогательные команды и утилиты](#вспомогательные-команды-и-утилиты)
## Управление TPM
### Инициализация и управление устройством
<pre>
<b>tpm2 startup</b>                    Инициализирует TPM после включения питания, выполняя самотестирование и восстанавливая состояние
<b>tpm2 shutdown</b>                   Выполняет необходимые операции перед выключением питания TPM, сохраняя его состояние
<b>tpm2 clear</b>                      Сбрасывает авторизацию владельца TPM (обычно требует авторизацию платформы)
<b>tpm2 clearcontrol</b>               Управляет возможностью сброса TPM с помощью физического присутствия или авторизации платформы
<b>tpm2 flushcontext</b>               Удаляет загруженный объект или сессию из памяти TPM
</pre>
### Управление иерархиями и авторизацией
<pre>
<b>tpm2 hierarchycontrol</b>           Управляет состоянием (включено/выключено) иерархий TPM (platform, storage, endorsement)
<b>tpm2 changeauth</b>                 Изменяет значение авторизации для объекта, иерархии или NV-индекса
<b>tpm2 changeeps</b>                  Изменяет первичное зерно иерархии подтверждения (Endorsement Primary Seed)
<b>tpm2 changepps</b>                  Изменяет первичное зерно иерархии платформы (Platform Primary Seed)
<b>tpm2 dictionarylockout</b>          Управляет параметрами блокировки при атаках перебором (например, на пароли)
</pre>
### Управление часами и генератором случайных чисел
<pre>
<b>tpm2 readclock</b>                  Считывает текущее значение часов (clock) и времени (time) TPM
<b>tpm2 setclock</b>                   Устанавливает текущее время TPM (требует авторизации)
<b>tpm2 clockrateadjust</b>            Регулирует скорость хода часов TPM
<b>tpm2 gettime</b>                    Считывает текущее время TPM, значение счетчика clock и информацию о сбросах
<b>tpm2 stirrandom</b>                 Добавляет предоставленные данные (энтропию) во внутренний генератор случайных чисел TPM
</pre>
### Самотестирование и аудит
<pre>
<b>tpm2 selftest</b>                   Запускает полное самотестирование TPM для проверки всех его функций
<b>tpm2 incrementalselftest</b>        Выполняет инкрементальное самотестирование TPM для проверки подмножества функций
<b>tpm2 gettestresult</b>              Получает результаты последнего выполненного самотестирования TPM
<b>tpm2 getcommandauditdigest</b>      Получает дайджест аудита выполненных команд TPM
<b>tpm2 getsessionauditdigest</b>      Получает дайджест аудита для конкретной сессии
<b>tpm2 setcommandauditstatus</b>      Включает или выключает аудит для указанных команд TPM
</pre>
## Управление ключами и объектами
### Создание ключей
<pre>
<b>tpm2 createprimary</b>              Создает первичный ключ в одной из иерархий TPM (endorsement, storage, platform, null)
<b>tpm2 create</b>                     Создает вторичный ключ или объект запечатанных данных под родительским ключом
<b>tpm2 createek</b>                   Создает ключ подтверждения (Endorsement Key)
<b>tpm2 createak</b>                   Создает ключ аттестации (Attestation Key)
</pre>
### Загрузка, выгрузка и импорт объектов
<pre>
<b>tpm2 load</b>                       Загружает ранее созданный (командой create) или импортированный объект (ключ или данные) в память TPM
<b>tpm2 loadexternal</b>               Загружает объект, который не требует родительского ключа (например, открытый ключ или объект HMAC/policy) в TPM
<b>tpm2 import</b>                     Импортирует внешний ключ или объект в TPM, обычно зашифрованный для родительского ключа
<b>tpm2 evictcontrol</b>               Управляет персистентностью объекта TPM, делая его постоянным (в NV) или временным (в RAM)
<b>tpm2 readpublic</b>                 Считывает публичную часть TPM-объекта (ключа или данных)
</pre>
### Использование ключей
<pre>
<b>tpm2 sign</b>                       Подписывает предоставленные данные (или хэш данных) с использованием загруженного асимметричного ключа
<b>tpm2 unseal</b>                     Извлекает (расшифровывает) данные из запечатанного объекта, если текущее состояние TPM удовлетворяет политике запечатывания
</pre>
### Миграция объектов
<pre>
<b>tpm2 duplicate</b>                  Создает дубликат TPM-объекта, который может быть загружен на другой TPM
</pre>
### Работа с учетными данными и сертификатами
<pre>
<b>tpm2 makecredential</b>             Создает зашифрованные учетные данные, которые могут быть активированы на другом TPM с помощью activatecredential
<b>tpm2 activatecredential</b>         Активирует учетные данные, связанные с объектом TPM
<b>tpm2 getekcertificate</b>           Получает сертификат ключа подтверждения (EK certificate), если он был записан в NV-память
<b>tpm2 certifyX509certutil</b>        Утилита для работы с сертификатами X.509, связанными с ключами TPM (часто для EK)
</pre>
## Криптографические операции
### Хеширование и HMAC
<pre>
<b>tpm2 hash</b>                       Вычисляет хэш предоставленных данных с использованием указанного алгоритма
<b>tpm2 hmac</b>                       Вычисляет HMAC (код аутентификации сообщения на основе хэша) для предоставленных данных
</pre>
### Симметричное шифрование/дешифрование
<pre>
<b>tpm2 encryptdecrypt</b>             Выполняет симметричное шифрование или дешифрование данных
</pre>
### Асимметричное шифрование/дешифрование RSA
<pre>
<b>tpm2 rsaencrypt</b>                 Выполняет RSA-шифрование данных с использованием загруженного RSA-ключа
<b>tpm2 rsadecrypt</b>                 Выполняет RSA-дешифрование данных с использованием загруженного RSA-ключа
</pre>
### Операции с эллиптическими кривыми
<pre>
<b>tpm2 geteccparameters</b>           Получает параметры заданной эллиптической кривой, поддерживаемой TPM
<b>tpm2 ecdhkeygen</b>                 Генерирует эфемерную пару ECC-ключей для протокола Диффи-Хеллмана на эллиптических кривых (ECDH)
<b>tpm2 ecephemeral</b>                Генерирует эфемерный ECC-ключ и начальное значение (seed) для двухфазного протокола генерации общего секрета (ZGen)
<b>tpm2 ecdhzgen</b>                   Вычисляет общий секрет Z в протоколе ECDH, используя открытый ECC-ключ другой стороны
<b>tpm2 commit</b>                     Выполняет вторую фазу двухфазной схемы обязательства для генерации ECC-ключа или параметра ECDH
<b>tpm2 zgen2phase</b>                 Выполняет вторую фазу двухэтапного протокола генерации ECC-ключа или вычисления общего секрета ECDH
</pre>
### Проверка подписи
<pre>
<b>tpm2 verifysignature</b>            Проверяет цифровую подпись данных с использованием указанного открытого ключа
</pre>
### Генерация случайных чисел
<pre>
<b>tpm2 getrandom</b>                 Генерирует указанное количество случайных байт от TPM
</pre>
## Аттестация
### Работа с PCR
<pre>
<b>tpm2 pcrallocate</b>                Выделяет PCR для использования с определенными банками хэш-алгоритмов
<b>tpm2 pcrextend</b>                  Расширяет значение PCR путем хеширования текущего значения PCR с новыми данными
<b>tpm2 pcrevent</b>                   Расширяет PCR указанным событием (часто используется для воспроизведения событий из системного журнала)
<b>tpm2 pcrread</b>                    Считывает текущие значения указанных PCR
<b>tpm2 pcrreset</b>                   Сбрасывает значение указанного PCR (если PCR имеет атрибут, разрешающий сброс)
<b>tpm2 eventlog</b>                   Читает и обрабатывает журнал событий TPM, который содержит измерения, расширяющие PCR
</pre>
### Отчеты
<pre>
<b>tpm2 quote</b>                      Создает подписанный отчет о значениях PCR, используя ключ аттестации (AK)
<b>tpm2 checkquote</b>                 Проверяет подпись и корректность отчета от TPM
</pre>
### Сертификация объектов
<pre>
<b>tpm2 certify</b>                    Удостоверяет свойства TPM-объекта путем его подписи ключом удостоверения
<b>tpm2 certifycreation</b>            Удостоверяет, что ключ был создан TPM, предоставляя тикет создания и подпись
</pre>
## NV-память
### Создание и удаление NV-индексов
<pre>
<b>tpm2 nvdefine</b>                   Создает новый индекс в NV-памяти TPM, задавая его размер и атрибуты
<b>tpm2 nvundefine</b>                 Удаляет ранее определенный NV-индекс
<b>tpm2 nvreadpublic</b>               Считывает публичную часть (атрибуты, размер) NV-индекса
</pre>
### Чтение и запись в NV-память
<pre>
<b>tpm2 nvread</b>                     Считывает данные из определенного NV-индекса
<b>tpm2 nvwrite</b>                    Записывает данные в определенный NV-индекс
<b>tpm2 nvextend</b>                   Расширяет (аналогично PCR extend) данные в NV-индексе типа "counter" или "extend"
<b>tpm2 nvincrement</b>                Увеличивает значение монотонного счетчика в NV-индексе
<b>tpm2 nvsetbits</b>                  Устанавливает указанные биты в NV-индексе типа "bits"
</pre>
### Блокировка и сертификация NV-индексов
<pre>
<b>tpm2 nvreadlock</b>                 Устанавливает блокировку на чтение для NV-индекса
<b>tpm2 nvwritelock</b>                Устанавливает блокировку на запись для NV-индекса
<b>tpm2 nvcertify</b>                  Создает подписанное утверждение о содержимом и атрибутах NV-индекса
</pre>
## Управление сессиями и политиками
### Управление сессиями
### Создание и управление политиками
### Условия политик
### Авторизация по политике
## Вспомогательные команды и утилиты
<pre>
<b>tpm2 getcap</b>                     Запрашивает различную информацию о возможностях TPM (например, поддерживаемые алгоритмы, свойства)
<b>tpm2 encodeobject</b>               Сериализует (кодирует) TPM-объект в его внешнее представление
<b>tpm2 testparms</b>                  Проверяет, поддерживаются ли указанные параметры алгоритма TPM
<b>tpm2 print</b>                      Печатает детали TPM-объекта в читаемом формате (утилита tpm2-tools)
<b>tpm2 rc_decode</b>                  Декодирует код ответа TPM в человекочитаемое сообщение об ошибке (утилита tpm2-tools)
<b>tpm2 send</b>                       Отправляет необработанную последовательность байт команды напрямую в TPM (низкоуровневая утилита tpm2-tools)
<b>tpm2 tr_encode</b>                  Кодирует дескриптор TPM (handle) в объект TR формата TSS ESAPI (специфично для TPM Software Stack)
</pre>
